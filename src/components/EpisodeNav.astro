<nav class="episodes">
  <div>
    <slot />
  </div>
</nav>

<portal-gate to="end:head">
  <style is:global>
    :root {
      view-transition-name: none;
    }
    nav.episodes {
      view-transition-name: episode-nav;
      background-color: light-dark(
        var(--sl-color-gray-6),
        var(--sl-color-gray-6)
      );
      border-radius: 2em;
      padding: 1.5em 1em;
      box-shadow: 0 4px 8px #8888;
      & div {
        width: fit-content;
        margin-inline: auto;
        background-color: var(--sl-color-gray-5);
        border-radius: 1em;
        padding: 0em 0.33em;
      }
    }

    nav.episodes span {
      margin: 0.5em;
      border-radius: 2em;
      padding: 10px 20px;
      background-color: transparent;
      color: light-dark(#000, #fff);
      &.selected {
        background-color: var(--sl-color-gray-1);
        view-transition-name: episode-nav-selected;
        a {
          color: var(--sl-color-black);
        }
      }
      a {
        color: var(--sl-color-white);
        view-transition-class: episode-nav-a;
        text-decoration: none;
      }
    }

    nav span a {
    }
    ::view-transition-group(episode-nav-selected) {
      animation-duration: 0.5s;
      animation-timing-function: ease-in-out;
    }
    ::view-transition-group(.episode-nav-a) {
      z-index: 1;
    }
    ::view-transition-group(episode-nav) {
      animation-duration: 0s;
    }

    nav.episodes span:nth-of-type(1) a {
      view-transition-name: episode-nav-a-1;
    }
    nav.episodes span:nth-of-type(2) a {
      view-transition-name: episode-nav-a-2;
    }
    nav.episodes span:nth-of-type(3) a {
      view-transition-name: episode-nav-a-3;
    }
  </style>

  <script is:inline>
    addEventListener("pagereveal", () => {
      document
        .querySelector("h1")
        ?.insertAdjacentElement(
          "beforebegin",
          document.querySelector("nav.episodes")
        );
    });
  </script>
</portal-gate>
